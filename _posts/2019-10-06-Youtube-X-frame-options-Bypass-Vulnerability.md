---
title: Vulnerability to bypass clickjacking Protection in YouTube
published: true
---

I found this vulnerability back in 2017, It was interesting as `X-frame-options :` response header was set to avoid clickjack but i was able to bypass and clickjack the youtube domain and its sub domains. Now let's discuss the vulnerability in detail.
<br>
<br>
<img src="https://spidersec.ninja/postimg/p1/img1.png" height="20%" width="70%">
<br>
<br>
In the above screenshot you can see `X-frame-options` header is set to `sameorigin` which should only allows the current site to frame the contents.

Vulnerability was simple, If `Referer` header value can be set to `https://google.com/any-end-point` while browser makes the request to load contents inside the iframe, it was possible to bypass there clickjacking protection.

STEPS TO REPRODUCE :

* Wrote a basic clickjacking exploit and saved it as `lol.html`.
  ```ruby
  # Html Code
  <iframe src="https://youtube.com" height="300" width="300">
  ```
* Turn on intercept in burp proxy.
* Open the `lol.html` in browser.
* Go to burp proxy and set Referer header as **Referer: https://google.com/onlinechallenge/**.
<br>
<br>
<img src="https://spidersec.ninja/postimg/p1/img2.png" height="20%" width="70%">
<br>
<br>
* Now you can see youtube.com is loaded inside iframe.
<br>
<br>
<img src="https://spidersec.ninja/postimg/p1/img3.png" height="20%" width="70%">
<br>
<br>
<img src="https://spidersec.ninja/postimg/p1/img4.png" height="20%" width="70%">
<br>
<br>

Thats it, thanks for reading.
