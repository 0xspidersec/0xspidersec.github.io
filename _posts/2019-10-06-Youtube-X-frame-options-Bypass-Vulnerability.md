---
title: Vulnerability to bypass X-frame-options header in YouTube
published: true
---

I found this vulnerability back in December 2017, It was interesting as `X-frame-options :` response header was set to avoid clickjack but i was able to bypass it and clickjack the whole youtube domain and its sub domains. Now let's discuss the vulnerability in detail.
<br>
<img src="https://spidersec.ninja/postimg/p1/img1.png" height="20%" width="50%">
<br>
In the above screenshot you can see `X-frame-options` header is set to `sameorigin` which should only allows the current site to frame the contents.

Vulnerability was simple, If `Referer` header value can be set to `https://google.com/any-end-point` while browser makes the request to load contents inside the iframe, it was possible to bypass there clickjacking protection.

STEPS TO REPRODUCE :

1. Wrote a basic clickjacking exploit and saved it as `test.html`.
```
<iframe src="https://youtube.com" height="300" width="300">

```
2. Turn on intercept in burp proxy.
3. Open the `test.html` in browser.
4. Go to burp proxy and set Referer header as `Referer: https://google.com/onlinechallenge/`.
<br>
<img src="https://spidersec.ninja/postimg/p1/img1.png" height="20%" width="50%">
<br>
5. Now you can see youtube.com is loaded inside iframe.
<br>
<img src="https://spidersec.ninja/postimg/p1/img1.png" height="20%" width="50%">
<br>
